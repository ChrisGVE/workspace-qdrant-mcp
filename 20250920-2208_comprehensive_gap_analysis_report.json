{
  "analysis_metadata": {
    "timestamp": "2025-09-20T22:08:00+02:00",
    "project_root": "/Users/chris/Dropbox/dev/ai/claude-code-cfg/mcp/workspace-qdrant-mcp",
    "analysis_type": "Comprehensive Gap Analysis",
    "target_architecture": "PRD v3.0 Four-Component Architecture"
  },
  "executive_summary": {
    "overall_alignment": "~35% architectural alignment",
    "critical_gaps": 2,
    "reusable_components": 6,
    "migration_complexity": "Complex - requires gRPC layer and tool consolidation"
  },
  "file_mappings": {
    "python_mcp_server": [
      "src/python/workspace_qdrant_mcp/server.py",
      "src/python/workspace_qdrant_mcp/tools/simplified_interface.py",
      "src/python/workspace_qdrant_mcp/tools/type_search.py",
      "src/python/workspace_qdrant_mcp/tools/document_memory_tools.py",
      "src/python/workspace_qdrant_mcp/tools/grpc_tools.py",
      "src/python/workspace_qdrant_mcp/tools/memory.py",
      "src/python/workspace_qdrant_mcp/tools/research.py",
      "src/python/workspace_qdrant_mcp/tools/scratchbook.py",
      "src/python/workspace_qdrant_mcp/tools/multitenant_tools.py",
      "src/python/workspace_qdrant_mcp/tools/documents.py",
      "src/python/workspace_qdrant_mcp/tools/multitenant_search.py",
      "src/python/workspace_qdrant_mcp/tools/dependency_analyzer.py",
      "src/python/workspace_qdrant_mcp/tools/__init__.py",
      "src/python/workspace_qdrant_mcp/tools/compatibility_layer.py",
      "src/python/workspace_qdrant_mcp/tools/watch_management.py",
      "src/python/workspace_qdrant_mcp/tools/symbol_resolver.py",
      "src/python/workspace_qdrant_mcp/tools/search.py",
      "src/python/workspace_qdrant_mcp/tools/state_management.py",
      "src/python/workspace_qdrant_mcp/tools/code_search.py",
      "src/python/workspace_qdrant_mcp/web/server.py",
      "src/python/workspace_qdrant_mcp/web/__init__.py",
      "src/python/workspace_qdrant_mcp/web/static/css/style.css",
      "src/python/workspace_qdrant_mcp/web/static/js/app.js",
      "src/python/workspace_qdrant_mcp/web/templates/index.html"
    ],
    "rust_daemon": [
      "src/rust/daemon/Cargo.toml",
      "src/rust/daemon/Cargo.lock",
      "src/rust/daemon/build.rs",
      "src/rust/daemon/.gitignore",
      "src/rust/daemon/python-bindings/Cargo.toml",
      "src/rust/daemon/python-bindings/src/lib.rs",
      "src/rust/daemon/core/Cargo.toml",
      "src/rust/daemon/core/tests/hybrid_search_comprehensive_tests.rs",
      "src/rust/daemon/core/tests/embedding_tests.rs",
      "src/rust/daemon/core/tests/embedding_basic_test.rs",
      "src/rust/daemon/core/tests/document_processor_tests.rs",
      "src/rust/daemon/core/tests/file_watching_tests.rs",
      "src/rust/daemon/core/tests/integration_tests.rs",
      "src/rust/daemon/core/examples/pattern_demo.rs",
      "src/rust/daemon/core/benches/platform_benchmarks.rs",
      "src/rust/daemon/core/benches/watching_benchmarks.rs",
      "src/rust/daemon/core/benches/processing_benchmarks.rs",
      "src/rust/daemon/core/src/ipc.rs",
      "src/rust/daemon/core/src/error.rs",
      "src/rust/daemon/core/src/config.rs",
      "src/rust/daemon/core/src/embedding.rs",
      "src/rust/daemon/core/src/lib.rs",
      "src/rust/daemon/core/src/logging.rs",
      "src/rust/daemon/core/src/watching.rs",
      "src/rust/daemon/core/src/unified_config.rs",
      "src/rust/daemon/core/src/processing.rs",
      "src/rust/daemon/core/src/storage.rs",
      "src/rust/daemon/core/src/lib.rs.original",
      "src/rust/daemon/core/src/daemon_state.rs",
      "src/rust/daemon/core/src/patterns/manager.rs",
      "src/rust/daemon/core/src/patterns/mod.rs",
      "src/rust/daemon/core/src/bin/memexd_priority.rs",
      "src/rust/daemon/core/src/bin/daemon_with_discovery.rs.broken",
      "src/rust/daemon/core/src/bin/memexd_service_demo.rs",
      "src/rust/daemon/core/src/bin/memexd.rs",
      "src/rust/daemon/core/src/watching/platform.rs",
      "src/rust/daemon/core/src/lsp/config.rs",
      "src/rust/daemon/core/src/lsp/detection.rs",
      "src/rust/daemon/core/src/lsp/mod.rs",
      "src/rust/daemon/core/src/lsp/state.rs",
      "src/rust/daemon/core/src/lsp/tests.rs",
      "src/rust/daemon/core/src/lsp/communication.rs",
      "src/rust/daemon/core/src/lsp/lifecycle.rs",
      "src/rust/daemon/core/src/service_discovery/health.rs",
      "src/rust/daemon/core/src/service_discovery/registry.rs",
      "src/rust/daemon/core/src/service_discovery/manager.rs",
      "src/rust/daemon/core/src/service_discovery/mod.rs",
      "src/rust/daemon/core/src/service_discovery/network.rs",
      "src/rust/daemon/proto/ingestion.proto",
      "src/rust/daemon/grpc/Cargo.toml",
      "src/rust/daemon/grpc/build.rs",
      "src/rust/daemon/grpc/src/lib.rs",
      "src/rust/daemon/grpc/src/service.rs"
    ],
    "cli_components": [],
    "configuration": [
      "pyproject.toml",
      "docker/k8s/deployment.yaml",
      "docker/k8s/persistentvolume.yaml",
      "docker/k8s/secrets.yaml",
      "docker/k8s/ingress.yaml",
      "docker/k8s/service.yaml",
      "docker/k8s/hpa.yaml",
      "docker/k8s/rbac.yaml",
      "docker/k8s/namespace.yaml",
      "docker/k8s/configmap.yaml",
      "patterns/include_patterns.yaml",
      "patterns/exclude_patterns.yaml",
      "patterns/language_extensions.yaml",
      "patterns/project_indicators.yaml",
      "examples/yaml_metadata_example.yaml",
      "templates/default_config.yaml",
      "templates/default_config.toml",
      "external/mcp-server-qdrant-retrieve/pnpm-lock.yaml",
      "assets/internal_configuration.yaml",
      "src/python/common/config/staging.yaml",
      "src/python/common/config/production.yaml",
      "src/python/common/config/development.yaml",
      "src/python/common/config/profiles/enterprise-deployment.yaml",
      "src/python/common/config/profiles/local-development.yaml",
      "src/python/common/config/profiles/kubernetes-deployment.yaml"
    ],
    "tests": [
      "tests/test_incremental_processor.py",
      "tests/test_dependency_analyzer.py",
      "tests/test_collection_naming.py",
      "tests/test_priority_queue_integration.py",
      "tests/test_collection_types.py",
      "tests/conftest.py",
      "tests/test_symbol_resolver.py",
      "tests/test_unified_config.py",
      "tests/test_pattern_manager_config_integration.py",
      "tests/test_sqlite_state_manager.py",
      "tests/test_readonly_access_control.py",
      "tests/test_pattern_manager.py",
      "tests/test_persistent_watch.py",
      "tests/test_production_deployment.py",
      "tests/test_sqlite_state_manager_comprehensive.py",
      "tests/__init__.py",
      "tests/test_daemon_integration.py",
      "tests/test_collection_integration.py",
      "tests/recall_precision_suite.py",
      "tests/run_sqlite_tests.py",
      "tests/test_config.py",
      "tests/test_error_handling_integration.py",
      "tests/production_readiness_validator.py",
      "tests/test_admin_cli.py",
      "tests/test_bug_fixes_validation.py",
      "tests/test_file_watching_comprehensive.py",
      "tests/test_priority_queue_manager.py",
      "tests/test_llm_access_control.py",
      "tests/test_monitoring_integration.py",
      "tests/test_daemon_manager.py",
      "tests/test_yaml_metadata.py",
      "tests/test_docker_deployment.py",
      "tests/stdio_console_silence/conftest.py",
      "tests/stdio_console_silence/test_console_capture.py",
      "tests/stdio_console_silence/test_integration_claude_desktop.py",
      "tests/stdio_console_silence/test_performance_benchmarks.py",
      "tests/stdio_console_silence/__init__.py",
      "tests/stdio_console_silence/test_mcp_protocol_purity.py",
      "tests/stdio_console_silence/run_console_silence_tests.py",
      "tests/unit/test_migration_reporting.py",
      "tests/unit/conftest_daemon.py",
      "tests/unit/test_hybrid_search.py",
      "tests/unit/test_memory_system.py",
      "tests/unit/test_research_interface.py",
      "tests/unit/test_depth_validation.py",
      "tests/unit/test_lsp_client.py",
      "tests/unit/test_daemon_manager_core.py",
      "tests/unit/test_search.py",
      "tests/unit/test_type_search.py",
      "tests/unit/test_parser_exceptions.py",
      "tests/unit/test_priority_queue_manager_core.py",
      "tests/unit/test_embeddings.py",
      "tests/unit/test_lsp_health_monitor.py",
      "tests/unit/test_config_migration.py",
      "tests/unit/test_daemon_ipc_communication.py",
      "tests/unit/test_lsp_detection_system.py",
      "tests/unit/__init__.py",
      "tests/unit/test_daemon_integration_workflows.py",
      "tests/unit/test_scratchbook.py",
      "tests/unit/test_lsp_metadata_extractor.py",
      "tests/unit/test_config_validator.py",
      "tests/unit/test_daemon_lsp_integration.py",
      "tests/unit/test_project_detection.py",
      "tests/unit/test_config.py",
      "tests/unit/test_file_watching_core.py",
      "tests/unit/test_cli_parsers.py",
      "tests/unit/test_progress_reporting.py",
      "tests/unit/test_ingestion_engine.py",
      "tests/unit/test_version_management.py",
      "tests/unit/test_code_search.py",
      "tests/unit/test_daemon_storage_integration.py",
      "tests/unit/test_performance_monitoring.py",
      "tests/unit/test_client.py",
      "tests/unit/test_collections.py",
      "tests/unit/test_ssl_config.py",
      "tests/unit/test_documents.py",
      "tests/unit/test_smart_ingestion_router.py",
      "tests/unit/test_file_detector.py",
      "tests/unit/test_sparse_vectors.py",
      "tests/core/test_config_system_validation.py",
      "tests/core/test_enhanced_config.py",
      "tests/memory/test_conflict_detector.py",
      "tests/memory/test_token_counter.py",
      "tests/memory/test_claude_integration.py",
      "tests/memory/test_memory_integration.py",
      "tests/memory/__init__.py",
      "tests/memory/test_memory_types.py",
      "tests/memory/test_memory_manager.py",
      "tests/memory/test_memory_schema.py",
      "tests/integration/test_daemon_lifecycle_integration.py",
      "tests/integration/test_mcp_server_comprehensive.py",
      "tests/integration/conftest.py",
      "tests/integration/test_grpc_mcp_integration.py",
      "tests/integration/test_server_integration.py",
      "tests/integration/test_migration_cli_integration.py",
      "tests/integration/test_multi_instance_daemon_framework.py",
      "tests/integration/__init__.py",
      "tests/integration/test_document_ingestion_pipeline.py",
      "tests/integration/test_fastmcp_protocol_compliance.py",
      "tests/integration/test_web_commands_integration.py",
      "tests/integration/test_lsp_detection_integration.py",
      "tests/integration/test_error_recovery_scenarios.py",
      "tests/integration/test_performance_regression.py",
      "tests/integration/test_watch_persistence.py",
      "tests/integration/test_watch_depth_integration.py",
      "tests/integration/test_cross_platform_service.py",
      "tests/integration/test_multi_component_communication.py",
      "tests/integration/test_ssl_optimization.py",
      "tests/integration/test_parser_infrastructure_integration.py",
      "tests/integration/test_stdio_communication.py",
      "tests/integration/test_grpc_payload_communication.py",
      "tests/integration/test_web_ui_integration.py",
      "tests/utils/metrics.py",
      "tests/utils/__init__.py",
      "tests/utils/deployment_helpers.py",
      "tests/cli/test_cli_binary_validation.py",
      "tests/cli/test_init_command.py",
      "tests/cli/test_lsp_management.py",
      "tests/cli/test_comprehensive_cli.py",
      "tests/cli/test_cli_validation_report.py",
      "tests/cli/test_watch_system.py",
      "tests/cli/test_web_ingestion.py",
      "tests/cli/test_status_cli.py",
      "tests/cli/test_comprehensive_document_ingestion_pipeline.py",
      "tests/cli/parsers/test_web_parser.py",
      "tests/cli/parsers/test_comprehensive_parser_validation.py",
      "tests/playwright/test_web_ui_functionality.py",
      "tests/fixtures/__init__.py",
      "tests/fixtures/test_data_collector.py",
      "tests/performance/test_metadata_filtering_performance.py",
      "tests/e2e/__init__.py",
      "tests/e2e/test_full_workflow.py",
      "tests/functional/test_search_functionality.py",
      "tests/functional/test_daemon_lifecycle_integration.py",
      "tests/functional/test_concurrent_watch_access.py",
      "tests/functional/test_mcp_integration.py",
      "tests/functional/__init__.py",
      "tests/functional/test_performance_load_testing.py",
      "tests/functional/test_data_ingestion.py",
      "tests/functional/test_cross_platform_compatibility.py",
      "tests/functional/test_performance.py",
      "tests/functional/test_recall_precision.py",
      "tests/functional/test_automated_infrastructure_reporting.py",
      "tests/functional/test_real_world_workflow_simulation.py",
      "tests/functional/test_error_recovery_edge_cases.py",
      "tests/functional/test_cli_command_workflows.py",
      "tests/functional/test_mcp_server_integration_e2e.py",
      "scripts/simple_config_test.py",
      "scripts/test_deployment_core.py",
      "scripts/run_web_ui_tests.py",
      "scripts/comprehensive_container_test.py",
      "scripts/run_comprehensive_container_tests.py",
      "scripts/containerized_integration_test.py",
      "scripts/run_integration_tests.py"
    ],
    "documentation": [],
    "unclassified": [
      "20250920-2208_codebase_inventory_analysis.py",
      "examples/sample_data_import.py",
      "examples/memory_system_demo.py",
      "examples/memory_usage.py",
      "examples/software_development/sample_project.py",
      "examples/software_development/code_documentation/sample_project/api.py",
      "scripts/validate_unified_config.py",
      "scripts/cross_platform_validation.py",
      "scripts/replace_print_statements.py",
      "scripts/issue_metrics_tracker.py",
      "src/python/elegant_launcher.py",
      "src/python/common/__init__.py",
      "src/python/common/tools/performance_benchmark_cli.py",
      "src/python/common/core/llm_access_control.py",
      "src/python/common/core/advanced_watch_config.py",
      "src/python/common/core/lsp_detector.py",
      "src/python/common/core/hybrid_search.py",
      "src/python/common/core/config.py",
      "src/python/common/core/sparse_vectors.py",
      "src/python/common/core/logging_config.py",
      "src/python/common/core/watch_config.py",
      "src/python/common/core/state_aware_ingestion.py",
      "src/python/common/core/lsp_metadata_extractor.py",
      "src/python/common/core/memory.py",
      "src/python/common/core/daemon_manager.py",
      "src/python/common/core/watch_validation.py",
      "src/python/common/core/ssl_config.py",
      "src/python/common/core/smart_ingestion_router.py",
      "src/python/common/core/yaml_config.py",
      "src/python/common/core/client.py",
      "src/python/common/core/grpc_client.py",
      "src/python/common/core/persistent_file_watcher.py",
      "src/python/common/core/metadata_optimization.py",
      "src/python/common/core/performance_monitor.py",
      "src/python/common/core/resource_manager.py",
      "src/python/common/core/priority_queue_manager.py",
      "src/python/common/core/multitenant_collections.py",
      "src/python/common/core/enhanced_config.py",
      "src/python/common/core/performance_metrics.py",
      "src/python/common/core/__init__.py",
      "src/python/common/core/daemon_client.py",
      "src/python/common/core/performance_monitoring.py",
      "src/python/common/core/sqlite_state_manager.py",
      "src/python/common/core/error_handling.py",
      "src/python/common/core/collection_naming.py",
      "src/python/common/core/lsp_config.py",
      "src/python/common/core/embeddings.py",
      "src/python/common/core/lsp_health_monitor.py",
      "src/python/common/core/pattern_manager.py",
      "src/python/common/core/claude_integration.py",
      "src/python/common/core/collections.py",
      "src/python/common/core/language_filters.py",
      "src/python/common/core/performance_analytics.py",
      "src/python/common/core/service_discovery_integration.py",
      "src/python/common/core/pure_daemon_client.py",
      "src/python/common/core/yaml_metadata.py",
      "src/python/common/core/lsp_notifications.py",
      "src/python/common/core/lsp_fallback.py",
      "src/python/common/core/file_watcher.py",
      "src/python/common/core/ingestion_config.py",
      "src/python/common/core/project_config_manager.py",
      "src/python/common/core/collection_types.py",
      "src/python/common/core/performance_storage.py",
      "src/python/common/core/incremental_processor.py",
      "src/python/common/core/depth_validation.py",
      "src/python/common/core/auto_ingestion.py",
      "src/python/common/core/watch_sync.py",
      "src/python/common/core/unified_config.py",
      "src/python/common/core/lsp_client.py",
      "src/python/common/core/service_discovery/registry.py",
      "src/python/common/core/service_discovery/health.py",
      "src/python/common/core/service_discovery/client.py",
      "src/python/common/core/service_discovery/__init__.py",
      "src/python/common/core/service_discovery/network.py",
      "src/python/common/core/service_discovery/exceptions.py",
      "src/python/common/core/service_discovery/manager.py",
      "src/python/common/memory/token_counter.py",
      "src/python/common/memory/__init__.py",
      "src/python/common/memory/types.py",
      "src/python/common/memory/conflict_detector.py",
      "src/python/common/memory/claude_integration.py",
      "src/python/common/memory/manager.py",
      "src/python/common/memory/schema.py",
      "src/python/common/grpc/ingestion_pb2_grpc.py",
      "src/python/common/grpc/client.py",
      "src/python/common/grpc/__init__.py",
      "src/python/common/grpc/types.py",
      "src/python/common/grpc/connection_manager.py",
      "src/python/common/grpc/ingestion_pb2.py",
      "src/python/common/optimization/__init__.py",
      "src/python/common/optimization/complete_fastmcp_optimization.py",
      "src/python/common/utils/project_detection.py",
      "src/python/common/utils/config_validator.py",
      "src/python/common/utils/__init__.py",
      "src/python/common/utils/admin_cli.py",
      "src/python/common/observability/metrics.py",
      "src/python/common/observability/health.py",
      "src/python/common/observability/monitoring.py",
      "src/python/common/observability/__init__.py",
      "src/python/common/observability/endpoints.py",
      "src/python/common/dashboard/__init__.py",
      "src/python/common/dashboard/performance_dashboard.py",
      "src/python/common/logging/loguru_config.py",
      "src/python/common/logging/__init__.py",
      "src/python/wqm_cli/__init__.py",
      "src/python/wqm_cli/cli_wrapper.py",
      "src/python/wqm_cli/cli/ingest.py",
      "src/python/wqm_cli/cli/memory.py",
      "src/python/wqm_cli/cli/health.py",
      "src/python/wqm_cli/cli/diagnostics.py",
      "src/python/wqm_cli/cli/__init__.py",
      "src/python/wqm_cli/cli/observability.py",
      "src/python/wqm_cli/cli/ingestion_engine.py",
      "src/python/wqm_cli/cli/formatting.py",
      "src/python/wqm_cli/cli/watch_service.py",
      "src/python/wqm_cli/cli/setup.py",
      "src/python/wqm_cli/cli/utils.py",
      "src/python/wqm_cli/cli/config_commands.py",
      "src/python/wqm_cli/cli/main.py",
      "src/python/wqm_cli/cli/enhanced_ingestion.py",
      "src/python/wqm_cli/cli/status.py",
      "src/python/wqm_cli/cli/parsers/pdf_parser.py",
      "src/python/wqm_cli/cli/parsers/markdown_parser.py",
      "src/python/wqm_cli/cli/parsers/html_parser.py",
      "src/python/wqm_cli/cli/parsers/docx_parser.py",
      "src/python/wqm_cli/cli/parsers/__init__.py",
      "src/python/wqm_cli/cli/parsers/pptx_parser.py",
      "src/python/wqm_cli/cli/parsers/exceptions.py",
      "src/python/wqm_cli/cli/parsers/file_detector.py",
      "src/python/wqm_cli/cli/parsers/code_parser.py",
      "src/python/wqm_cli/cli/parsers/progress.py",
      "src/python/wqm_cli/cli/parsers/text_parser.py",
      "src/python/wqm_cli/cli/parsers/epub_parser.py",
      "src/python/wqm_cli/cli/parsers/base.py",
      "src/python/wqm_cli/cli/parsers/web_parser.py",
      "src/python/wqm_cli/cli/parsers/web_crawler.py",
      "src/python/wqm_cli/cli/parsers/mobi_parser.py",
      "src/python/wqm_cli/cli/commands/service.py",
      "src/python/wqm_cli/cli/commands/ingest.py",
      "src/python/wqm_cli/cli/commands/web.py",
      "src/python/wqm_cli/cli/commands/config.py",
      "src/python/wqm_cli/cli/commands/library.py",
      "src/python/wqm_cli/cli/commands/memory.py",
      "src/python/wqm_cli/cli/commands/__init__.py",
      "src/python/wqm_cli/cli/commands/admin.py",
      "src/python/wqm_cli/cli/commands/search.py",
      "src/python/wqm_cli/cli/commands/watch.py",
      "src/python/wqm_cli/cli/commands/service_fixed.py",
      "src/python/wqm_cli/cli/commands/lsp_management.py",
      "src/python/wqm_cli/cli/commands/init.py",
      "src/python/workspace_qdrant_mcp/stdio_server.py",
      "src/python/workspace_qdrant_mcp/elegant_server.py",
      "src/python/workspace_qdrant_mcp/entry_point.py",
      "src/python/workspace_qdrant_mcp/__init__.py",
      "src/python/workspace_qdrant_mcp/standalone_stdio_server.py",
      "src/python/workspace_qdrant_mcp/server_logging_fix.py",
      "src/python/workspace_qdrant_mcp/launcher.py",
      "src/python/workspace_qdrant_mcp/isolated_stdio_server.py",
      "src/python/workspace_qdrant_mcp/utils/__init__.py",
      "src/python/workspace_qdrant_mcp/utils/migration.py",
      "src/python/workspace_qdrant_mcp/validation/project_isolation.py",
      "src/python/workspace_qdrant_mcp/validation/__init__.py",
      "src/python/workspace_qdrant_mcp/validation/decorators.py"
    ]
  },
  "component_analysis": {
    "component_1_rust_engine": {
      "component_name": "Rust Engine",
      "target_description": "Ingestion and Watching Daemon (Rust Engine)",
      "current_files": [
        "src/rust/daemon/Cargo.toml",
        "src/rust/daemon/Cargo.lock",
        "src/rust/daemon/build.rs",
        "src/rust/daemon/.gitignore",
        "src/rust/daemon/python-bindings/Cargo.toml",
        "src/rust/daemon/python-bindings/src/lib.rs",
        "src/rust/daemon/core/Cargo.toml",
        "src/rust/daemon/core/tests/hybrid_search_comprehensive_tests.rs",
        "src/rust/daemon/core/tests/embedding_tests.rs",
        "src/rust/daemon/core/tests/embedding_basic_test.rs",
        "src/rust/daemon/core/tests/document_processor_tests.rs",
        "src/rust/daemon/core/tests/file_watching_tests.rs",
        "src/rust/daemon/core/tests/integration_tests.rs",
        "src/rust/daemon/core/examples/pattern_demo.rs",
        "src/rust/daemon/core/benches/platform_benchmarks.rs",
        "src/rust/daemon/core/benches/watching_benchmarks.rs",
        "src/rust/daemon/core/benches/processing_benchmarks.rs",
        "src/rust/daemon/core/src/ipc.rs",
        "src/rust/daemon/core/src/error.rs",
        "src/rust/daemon/core/src/config.rs",
        "src/rust/daemon/core/src/embedding.rs",
        "src/rust/daemon/core/src/lib.rs",
        "src/rust/daemon/core/src/logging.rs",
        "src/rust/daemon/core/src/watching.rs",
        "src/rust/daemon/core/src/unified_config.rs",
        "src/rust/daemon/core/src/processing.rs",
        "src/rust/daemon/core/src/storage.rs",
        "src/rust/daemon/core/src/lib.rs.original",
        "src/rust/daemon/core/src/daemon_state.rs",
        "src/rust/daemon/core/src/patterns/manager.rs",
        "src/rust/daemon/core/src/patterns/mod.rs",
        "src/rust/daemon/core/src/bin/memexd_priority.rs",
        "src/rust/daemon/core/src/bin/daemon_with_discovery.rs.broken",
        "src/rust/daemon/core/src/bin/memexd_service_demo.rs",
        "src/rust/daemon/core/src/bin/memexd.rs",
        "src/rust/daemon/core/src/watching/platform.rs",
        "src/rust/daemon/core/src/lsp/config.rs",
        "src/rust/daemon/core/src/lsp/detection.rs",
        "src/rust/daemon/core/src/lsp/mod.rs",
        "src/rust/daemon/core/src/lsp/state.rs",
        "src/rust/daemon/core/src/lsp/tests.rs",
        "src/rust/daemon/core/src/lsp/communication.rs",
        "src/rust/daemon/core/src/lsp/lifecycle.rs",
        "src/rust/daemon/core/src/service_discovery/health.rs",
        "src/rust/daemon/core/src/service_discovery/registry.rs",
        "src/rust/daemon/core/src/service_discovery/manager.rs",
        "src/rust/daemon/core/src/service_discovery/mod.rs",
        "src/rust/daemon/core/src/service_discovery/network.rs",
        "src/rust/daemon/proto/ingestion.proto",
        "src/rust/daemon/grpc/Cargo.toml",
        "src/rust/daemon/grpc/build.rs",
        "src/rust/daemon/grpc/src/lib.rs",
        "src/rust/daemon/grpc/src/service.rs"
      ],
      "missing_elements": [],
      "reusable_elements": [
        "DocumentProcessor",
        "EmbeddingGenerator",
        "Storage abstractions",
        "Error handling framework"
      ],
      "communication_protocols": [
        "IPC",
        "Direct library calls"
      ],
      "alignment_percentage": 40.0
    },
    "component_2_python_mcp": {
      "component_name": "Python MCP Server",
      "target_description": "MCP Server (Python MCP)",
      "current_files": [
        "src/python/workspace_qdrant_mcp/server.py",
        "src/python/workspace_qdrant_mcp/tools/simplified_interface.py",
        "src/python/workspace_qdrant_mcp/tools/type_search.py",
        "src/python/workspace_qdrant_mcp/tools/document_memory_tools.py",
        "src/python/workspace_qdrant_mcp/tools/grpc_tools.py",
        "src/python/workspace_qdrant_mcp/tools/memory.py",
        "src/python/workspace_qdrant_mcp/tools/research.py",
        "src/python/workspace_qdrant_mcp/tools/scratchbook.py",
        "src/python/workspace_qdrant_mcp/tools/multitenant_tools.py",
        "src/python/workspace_qdrant_mcp/tools/documents.py",
        "src/python/workspace_qdrant_mcp/tools/multitenant_search.py",
        "src/python/workspace_qdrant_mcp/tools/dependency_analyzer.py",
        "src/python/workspace_qdrant_mcp/tools/__init__.py",
        "src/python/workspace_qdrant_mcp/tools/compatibility_layer.py",
        "src/python/workspace_qdrant_mcp/tools/watch_management.py",
        "src/python/workspace_qdrant_mcp/tools/symbol_resolver.py",
        "src/python/workspace_qdrant_mcp/tools/search.py",
        "src/python/workspace_qdrant_mcp/tools/state_management.py",
        "src/python/workspace_qdrant_mcp/tools/code_search.py",
        "src/python/workspace_qdrant_mcp/web/server.py",
        "src/python/workspace_qdrant_mcp/web/__init__.py",
        "src/python/workspace_qdrant_mcp/web/static/css/style.css",
        "src/python/workspace_qdrant_mcp/web/static/js/app.js",
        "src/python/workspace_qdrant_mcp/web/templates/index.html"
      ],
      "missing_elements": [
        "gRPC client",
        "4-tool consolidation",
        "Memory rule injection"
      ],
      "reusable_elements": [
        "Hybrid search",
        "Project detection",
        "Collection management"
      ],
      "communication_protocols": [
        "Direct Python-Rust calls",
        "MCP protocol"
      ],
      "alignment_percentage": 30.0
    },
    "component_3_cli_utility": {
      "component_name": "CLI Utility",
      "target_description": "CLI Utility (wqm)",
      "current_files": [],
      "missing_elements": [
        "Unified wqm interface",
        "Daemon lifecycle management"
      ],
      "reusable_elements": [
        "Document parsers",
        "Configuration validation"
      ],
      "communication_protocols": [
        "Direct Python calls"
      ],
      "alignment_percentage": 40.0
    },
    "component_4_context_injector": {
      "component_name": "Context Injector",
      "target_description": "Context Injector (LSP Integration/Hook)",
      "current_files": [],
      "missing_elements": [
        "Complete component missing",
        "LSP integration",
        "Rule streaming"
      ],
      "reusable_elements": [],
      "communication_protocols": [],
      "alignment_percentage": 0.0
    }
  },
  "communication_analysis": {
    "current_patterns": [
      "Direct Python-to-Rust library calls",
      "IPC communication",
      "MCP protocol to Claude Code"
    ],
    "target_patterns": [
      "gRPC between all components",
      "MCP protocol to Claude Code",
      "SQLite for state management"
    ],
    "missing_implementations": [
      "gRPC service layer in Rust daemon",
      "gRPC client in Python MCP server",
      "gRPC communication in CLI utility"
    ]
  },
  "gap_analysis": [
    {
      "gap_type": "Communication Protocol",
      "current_state": "Direct Python-Rust library calls",
      "target_state": "gRPC-based communication",
      "impact_level": "critical",
      "migration_complexity": "complex",
      "reusable_components": [
        "Error handling",
        "Data structures"
      ]
    },
    {
      "gap_type": "Tool Architecture",
      "current_state": "30+ individual MCP tools",
      "target_state": "4 consolidated tools",
      "impact_level": "high",
      "migration_complexity": "moderate",
      "reusable_components": [
        "Hybrid search",
        "Collection management",
        "Validation"
      ]
    },
    {
      "gap_type": "CLI Interface",
      "current_state": "Fragmented CLI components",
      "target_state": "Unified wqm interface",
      "impact_level": "medium",
      "migration_complexity": "moderate",
      "reusable_components": [
        "Document parsers",
        "Configuration system"
      ]
    },
    {
      "gap_type": "Context Injection",
      "current_state": "No LSP integration",
      "target_state": "Complete context injector component",
      "impact_level": "critical",
      "migration_complexity": "complex",
      "reusable_components": []
    }
  ],
  "reusable_analysis": {
    "rust_components": {
      "document_processor": {
        "location": "src/rust/daemon/core/",
        "reusability": "high",
        "migration_effort": "low"
      },
      "embedding_generator": {
        "location": "src/rust/daemon/core/",
        "reusability": "high",
        "migration_effort": "low"
      },
      "storage_abstractions": {
        "location": "src/rust/daemon/core/",
        "reusability": "medium",
        "migration_effort": "medium"
      }
    },
    "python_components": {
      "hybrid_search": {
        "location": "src/python/common/core/hybrid_search.py",
        "reusability": "high",
        "migration_effort": "low"
      },
      "project_detection": {
        "location": "src/python/common/core/project_detection.py",
        "reusability": "high",
        "migration_effort": "low"
      },
      "collection_management": {
        "location": "src/python/workspace_qdrant_mcp/server.py",
        "reusability": "medium",
        "migration_effort": "medium"
      }
    },
    "deprecated_components": {
      "fragmented_tools": {
        "location": "src/python/workspace_qdrant_mcp/server.py",
        "replacement": "4 consolidated tools",
        "migration_strategy": "Tool consolidation with backward compatibility"
      }
    }
  },
  "recommendations": {
    "phase_1": "Implement gRPC communication layer",
    "phase_2": "Consolidate MCP tools (30+ \u2192 4)",
    "phase_3": "Create unified CLI interface",
    "phase_4": "Implement context injector component"
  }
}