{
  "test_execution": {
    "total_tests": 25,
    "passed_tests": 25,
    "failed_tests": 0,
    "success_rate": 100.0
  },
  "security_analysis": {
    "total_violations": 0,
    "security_score": 100
  },
  "test_breakdown": {
    "LLM Access Control Integration": {
      "total": 2,
      "passed": 2,
      "failed": 0
    },
    "System Collection Protection": {
      "total": 3,
      "passed": 3,
      "failed": 0
    },
    "Library Collection Read-Only": {
      "total": 3,
      "passed": 3,
      "failed": 0
    },
    "Memory Collection Deletion Protection": {
      "total": 2,
      "passed": 2,
      "failed": 0
    },
    "Parameter Manipulation Prevention": {
      "total": 3,
      "passed": 3,
      "failed": 0
    },
    "Clear Error Messages": {
      "total": 1,
      "passed": 1,
      "failed": 0
    },
    "Source-Aware Validation": {
      "total": 4,
      "passed": 4,
      "failed": 0
    },
    "Edge Cases and Malformed Inputs": {
      "total": 3,
      "passed": 3,
      "failed": 0
    },
    "Rule Consistency": {
      "total": 4,
      "passed": 4,
      "failed": 0
    }
  },
  "violations": [],
  "detailed_results": [
    {
      "test_suite": "LLM Access Control Integration",
      "test_case": "LLM create system collection",
      "operation": "create",
      "collection": "__new_system",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Invalid collection name format: '__new_system' - Library name '_new_system' must start with a letter, contain only lowercase letters, numbers, hyphens, and underscores, and end with a letter or number (or be a single letter)"
    },
    {
      "test_suite": "LLM Access Control Integration",
      "test_case": "LLM create valid project collection",
      "operation": "create",
      "collection": "myproject-docs",
      "source": "llm",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "System Collection Protection",
      "test_case": "MCP write to system memory collection",
      "operation": "write",
      "collection": "__system_memory",
      "source": "mcp",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "System memory collection '__system_memory' is read-only from MCP"
    },
    {
      "test_suite": "System Collection Protection",
      "test_case": "MCP delete system admin collection",
      "operation": "delete",
      "collection": "__admin_config",
      "source": "mcp",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "MCP cannot delete system collection '__admin_config' - use CLI with admin privileges"
    },
    {
      "test_suite": "System Collection Protection",
      "test_case": "CLI create system collection",
      "operation": "create",
      "collection": "__new_admin",
      "source": "cli",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Library Collection Read-Only",
      "test_case": "MCP write to library collection",
      "operation": "write",
      "collection": "_mylib",
      "source": "mcp",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Library collection '_mylib' is read-only from MCP - use CLI to modify"
    },
    {
      "test_suite": "Library Collection Read-Only",
      "test_case": "CLI write to library collection",
      "operation": "write",
      "collection": "_mylib",
      "source": "cli",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Library Collection Read-Only",
      "test_case": "LLM read from library collection",
      "operation": "read",
      "collection": "_mylib",
      "source": "llm",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Memory Collection Deletion Protection",
      "test_case": "LLM delete project memory collection",
      "operation": "delete",
      "collection": "project-memory",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "LLM cannot delete memory collection 'project-memory' - memory collections contain persistent state"
    },
    {
      "test_suite": "Memory Collection Deletion Protection",
      "test_case": "LLM delete global memory collection",
      "operation": "delete",
      "collection": "memory",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "LLM cannot delete global collection 'memory' - global collections are system-wide resources"
    },
    {
      "test_suite": "Parameter Manipulation Prevention",
      "test_case": "Empty collection name bypass",
      "operation": "create",
      "collection": "",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Collection name must be a non-empty string"
    },
    {
      "test_suite": "Parameter Manipulation Prevention",
      "test_case": "Whitespace-only name bypass",
      "operation": "create",
      "collection": "   ",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Collection name must be a non-empty string"
    },
    {
      "test_suite": "Parameter Manipulation Prevention",
      "test_case": "Excessively long name bypass",
      "operation": "create",
      "collection": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Invalid collection name format: Collection name cannot exceed 100 characters"
    },
    {
      "test_suite": "Clear Error Messages",
      "test_case": "Collection not found error",
      "passed": true,
      "error_message": "Collection 'nonexistent' does not exist"
    },
    {
      "test_suite": "Source-Aware Validation",
      "test_case": "System collection creation by source - llm",
      "operation": "create",
      "collection": "__new_system",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Invalid collection name format: '__new_system' - Library name '_new_system' must start with a letter, contain only lowercase letters, numbers, hyphens, and underscores, and end with a letter or number (or be a single letter)"
    },
    {
      "test_suite": "Source-Aware Validation",
      "test_case": "System collection creation by source - cli",
      "operation": "create",
      "collection": "__new_system",
      "source": "cli",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Source-Aware Validation",
      "test_case": "System collection creation by source - system",
      "operation": "create",
      "collection": "__new_system",
      "source": "system",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Source-Aware Validation",
      "test_case": "System collection creation by source - mcp",
      "operation": "create",
      "collection": "__new_system",
      "source": "mcp",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Edge Cases and Malformed Inputs",
      "test_case": "Single character collection name",
      "operation": "create",
      "collection": "a",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Collection name 'a' does not follow recognized patterns - use 'project-suffix' format"
    },
    {
      "test_suite": "Edge Cases and Malformed Inputs",
      "test_case": "Single underscore collection name",
      "operation": "create",
      "collection": "_",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Invalid collection name format: Library name cannot be empty after underscore"
    },
    {
      "test_suite": "Edge Cases and Malformed Inputs",
      "test_case": "Create existing collection",
      "operation": "create",
      "collection": "project-docs",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Collection 'project-docs' already exists"
    },
    {
      "test_suite": "Rule Consistency",
      "test_case": "Consistency: create __system_memory as llm",
      "operation": "create",
      "collection": "__system_memory",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Collection '__system_memory' already exists"
    },
    {
      "test_suite": "Rule Consistency",
      "test_case": "Consistency: read __system_memory as llm",
      "operation": "read",
      "collection": "__system_memory",
      "source": "llm",
      "expected_valid": true,
      "actual_valid": true,
      "passed": true,
      "error_message": null
    },
    {
      "test_suite": "Rule Consistency",
      "test_case": "Consistency: write __system_memory as llm",
      "operation": "write",
      "collection": "__system_memory",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Invalid collection name format: '__system_memory' - Library name '_system_memory' must start with a letter, contain only lowercase letters, numbers, hyphens, and underscores, and end with a letter or number (or be a single letter)"
    },
    {
      "test_suite": "Rule Consistency",
      "test_case": "Consistency: delete __system_memory as llm",
      "operation": "delete",
      "collection": "__system_memory",
      "source": "llm",
      "expected_valid": false,
      "actual_valid": false,
      "passed": true,
      "error_message": "Invalid collection name format: '__system_memory' - Library name '_system_memory' must start with a letter, contain only lowercase letters, numbers, hyphens, and underscores, and end with a letter or number (or be a single letter)"
    }
  ],
  "compliance_status": {
    "overall_compliant": true
  }
}