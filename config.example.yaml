# Example daemon configuration for workspace-qdrant-mcp
# This file demonstrates all available configuration options

# Core daemon settings
log_level: "info"  # error, warn, info, debug, trace
enable_metrics: true
metrics_interval_secs: 60
max_concurrent_tasks: 4
default_timeout_ms: 30000
enable_preemption: true
chunk_size: 1000

# Qdrant connection configuration
qdrant:
  url: "http://localhost:6333"
  # api_key: "your-api-key-here"  # Optional for Qdrant Cloud
  transport: "http"  # http or grpc
  timeout: 30
  max_retries: 3
  check_compatibility: true

# Auto-ingestion configuration
auto_ingestion:
  enabled: true
  auto_create_watches: true
  include_common_files: true
  include_source_files: true
  target_collection_suffix: "scratchbook"
  max_files_per_batch: 5
  batch_delay_seconds: 2.0
  max_file_size_mb: 50
  recursive_depth: 5
  debounce_seconds: 10

# Optimized auto-ingestion for large file sets
optimized_ingestion:
  # Control parallel file processing (1-50)
  max_concurrent_files: 10
  # Configure batch processing size (1-500)
  batch_size: 50
  # Enable adaptive batch sizing based on system resources
  adaptive_batch_sizing: true
  # Toggle file deduplication within sessions
  enable_deduplication: true
  # Deduplication strategy: "path", "content_hash", "mtime"
  deduplication_strategy: "content_hash"
  # Set progress update frequency in seconds
  progress_interval_seconds: 1.0
  # Enable progress callbacks
  enable_progress_callbacks: true
  # Maximum memory usage in MB (100-2048)
  max_memory_usage_mb: 512.0
  # Maximum CPU percent to use (10-100)
  max_cpu_percent: 80.0
  # Enable adaptive resource scaling
  adaptive_resource_scaling: true
  # File processing timeout in seconds
  file_timeout_seconds: 60.0
  # Batch processing timeout in seconds
  batch_timeout_seconds: 300.0
  # Maximum operation timeout in seconds (1 hour default)
  operation_timeout_seconds: 3600.0
  # Maximum retry attempts for failed files
  max_retries: 3
  # Delay between retries in seconds
  retry_delay_seconds: 1.0

# Queue processor configuration
queue_processor:
  # Number of items to dequeue per batch (1-1000)
  batch_size: 10

  # Poll interval in milliseconds (1-60000)
  poll_interval_ms: 500

  # Maximum retry attempts before marking failed (0-20)
  max_retries: 5

  # Retry delays in seconds [1m, 5m, 15m, 1h]
  # Exponential backoff pattern
  retry_delays_seconds: [60, 300, 900, 3600]

  # Target throughput for monitoring (docs per minute)
  target_throughput: 1000

  # Enable detailed metrics logging
  enable_metrics: true

# Enhanced logging configuration
logging:
  info_includes_connection_events: true
  info_includes_transport_details: true
  info_includes_retry_attempts: true
  info_includes_fallback_behavior: true
  error_includes_stack_trace: true
  error_includes_connection_state: true

# Environment variable overrides:
# WQM_QUEUE_BATCH_SIZE - Override batch_size
# WQM_QUEUE_POLL_INTERVAL_MS - Override poll_interval_ms
# WQM_QUEUE_MAX_RETRIES - Override max_retries
# WQM_QUEUE_TARGET_THROUGHPUT - Override target_throughput
# WQM_QUEUE_ENABLE_METRICS - Override enable_metrics (true/false or 1/0)
# WQM_OPTIMIZED_MAX_CONCURRENT - Override optimized_ingestion.max_concurrent_files
# WQM_OPTIMIZED_BATCH_SIZE - Override optimized_ingestion.batch_size
# WQM_OPTIMIZED_DEDUP_ENABLED - Override optimized_ingestion.enable_deduplication
